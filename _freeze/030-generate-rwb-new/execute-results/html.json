{
  "hash": "d9b3d64568209c127df5448bce6c0be5",
  "result": {
    "engine": "knitr",
    "markdown": "# Generate RWB data frame {#sec-chap030}\n\n\n\n\n\n::::: {#obj-chap030}\n:::: {.my-objectives}\n::: {.my-objectives-header}\nObjectives\n:::\n\n::: {.my-objectives-container}\n\nGenerate the `rwb-new` dataset to work on.\n\n\n:::\n::::\n:::::\n\nI will start with the generation of the dataset for 2022-2025. `rwb-new` should work as my model for the displaying my first RWB world map.\n\nTo get a full dataset for 2022 I will need to work on the 2021 data as well, because I have to compare for each year the score/rank differences with the previous year.\n\nHere now I have to pay attention the small differences between the various datasets. Therefore I have to work on each year separetely.\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-030-generate-rwb-new}\n: Generate RWB dataset for 2022-2025\n::::::\n:::\n::::{.my-r-code-container}\n\n<center>**Run this code chunk manually if the file(s) still needs to be downloaded.**</center>\n\n\n::: {.cell}\n\n```{#lst-030-generate-rwb-new .r .cell-code  lst-cap=\"Generate RWB dataset for 2022-2025\"}\nlibrary(dplyr, warn.conflicts = FALSE)\n\nrsf2021 <- readRDS(paste0(here::here(), \"/data/chap010/rsf2021.rds\"))\nrsf2022 <- readRDS(paste0(here::here(), \"/data/chap010/rsf2022.rds\"))\nrsf2023 <- readRDS(paste0(here::here(), \"/data/chap010/rsf2023.rds\"))\nrsf2024 <- readRDS(paste0(here::here(), \"/data/chap010/rsf2024.rds\"))\nrsf2025 <- readRDS(paste0(here::here(), \"/data/chap010/rsf2025.rds\"))\n\nrwb2021 <- rwb_old(rsf2021)\n\nrwb2021_short <- rwb2021 |>\n    select(c(iso, score_n, score_n_situation)) |>\n    rename(\n        score_n_1 = score_n,\n        score_n_1_situation = score_n_situation\n        )\n\nrwb2022 <- rwb_new(rsf2022) |>\n    left_join(rwb2021_short, \"iso\") |>\n    mutate(\n        score_evolution = score - score_n_1\n    ) |>\n    relocate(score_n_1:score_evolution, .after = rank_evolution)\n\nrwb2023 <- rwb_new(rsf2023) |>\n    df_recoded_new(score_n_1) |>\n    mutate(score_evolution =\n               as.double(stringr::str_replace(score_evolution, \",\", \".\"))\n    )\n\n\nrwb2024 <- rwb_new(rsf2024) |>\n    select(-situation) |>\n    df_recoded_new(score_n_1) |>\n    mutate(score_evolution =\n               as.double(stringr::str_replace(score_evolution, \",\", \".\"))\n    )\n\nrwb2025 <- rsf2025 |>\n    rename(Score = `Score 2025`) |>\n    rwb_new() |>\n    mutate(\n        country_en = case_when(\n        stringr::str_detect(country_en, \"d'Ivoire\") ~ \"Côte d'Ivoire\",\n        stringr::str_detect(country_en, \"rkiye\") ~ \"Türkiye\",\n        .default = country_en\n    ),\n        zone = if_else(stringr::str_detect(zone, \"riques\"),\n                \"Amériques\", zone)\n    ) |>\n    mutate(score_evolution =\n               as.double(stringr::str_replace(score_evolution, \",\", \".\"))\n    ) |>\n    df_recoded_new(score_n_1)\n\n\n\nrwb <- bind_rows(\n    rwb2022, rwb2023, rwb2024, rwb2025\n    ) |>\n    mutate(across(where(is.character), as.factor)) |> \n    arrange(desc(year), desc(score))\n\nmy_save_data_file(\"chap030\", rwb, \"rwb.rds\")\n```\n:::\n\n\n::::\n:::::\n\n\n\n## Glossary Entries {.unnumbered}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n#> data frame with 0 columns and 0 rows\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Session Info {.unnumbered}\n\n::: my-r-code\n::: my-r-code-header\nSession Info\n:::\n\n::: my-r-code-container\n\n::: {.cell}\n\n```{.r .cell-code}\nsessioninfo::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> ─ Session info ───────────────────────────────────────────────────────────────\n#>  setting  value\n#>  version  R version 4.5.1 (2025-06-13)\n#>  os       macOS Sequoia 15.6\n#>  system   aarch64, darwin20\n#>  ui       X11\n#>  language (EN)\n#>  collate  en_US.UTF-8\n#>  ctype    en_US.UTF-8\n#>  tz       Europe/Vienna\n#>  date     2025-08-13\n#>  pandoc   3.7.0.2 @ /opt/homebrew/bin/ (via rmarkdown)\n#>  quarto   1.8.4 @ /usr/local/bin/quarto\n#> \n#> ─ Packages ───────────────────────────────────────────────────────────────────\n#>  package     * version    date (UTC) lib source\n#>  cli           3.6.5      2025-04-23 [1] CRAN (R 4.5.0)\n#>  curl          6.4.0      2025-06-22 [1] CRAN (R 4.5.0)\n#>  digest        0.6.37     2024-08-19 [1] CRAN (R 4.5.0)\n#>  dplyr       * 1.1.4      2023-11-17 [1] CRAN (R 4.5.0)\n#>  evaluate      1.0.4      2025-06-18 [1] CRAN (R 4.5.0)\n#>  fastmap       1.2.0      2024-05-15 [1] CRAN (R 4.5.0)\n#>  generics      0.1.4      2025-05-09 [1] CRAN (R 4.5.0)\n#>  glossary    * 1.0.0.9003 2025-06-08 [1] local\n#>  glue          1.8.0      2024-09-30 [1] CRAN (R 4.5.0)\n#>  here          1.0.1      2020-12-13 [1] CRAN (R 4.5.0)\n#>  htmltools     0.5.8.1    2024-04-04 [1] CRAN (R 4.5.0)\n#>  htmlwidgets   1.6.4      2023-12-06 [1] CRAN (R 4.5.0)\n#>  jsonlite      2.0.0      2025-03-27 [1] CRAN (R 4.5.0)\n#>  knitr         1.50       2025-03-16 [1] CRAN (R 4.5.0)\n#>  lifecycle     1.0.4      2023-11-07 [1] CRAN (R 4.5.0)\n#>  magrittr      2.0.3      2022-03-30 [1] CRAN (R 4.5.0)\n#>  pillar        1.11.0     2025-07-04 [1] CRAN (R 4.5.0)\n#>  pkgconfig     2.0.3      2019-09-22 [1] CRAN (R 4.5.0)\n#>  R6            2.6.1      2025-02-15 [1] CRAN (R 4.5.0)\n#>  rlang         1.1.6      2025-04-11 [1] CRAN (R 4.5.0)\n#>  rmarkdown     2.29       2024-11-04 [1] CRAN (R 4.5.0)\n#>  rprojroot     2.1.0      2025-07-12 [1] CRAN (R 4.5.0)\n#>  rstudioapi    0.17.1     2024-10-22 [1] CRAN (R 4.5.0)\n#>  rversions     2.1.2      2022-08-31 [1] CRAN (R 4.5.0)\n#>  sessioninfo   1.2.3      2025-02-05 [1] CRAN (R 4.5.0)\n#>  tibble        3.3.0      2025-06-08 [1] CRAN (R 4.5.0)\n#>  tidyselect    1.2.1      2024-03-11 [1] CRAN (R 4.5.0)\n#>  vctrs         0.6.5      2023-12-01 [1] CRAN (R 4.5.0)\n#>  xfun          0.52       2025-04-02 [1] CRAN (R 4.5.0)\n#>  xml2          1.3.8      2025-03-14 [1] CRAN (R 4.5.0)\n#>  yaml          2.3.10     2024-07-26 [1] CRAN (R 4.5.0)\n#> \n#>  [1] /Library/Frameworks/R.framework/Versions/4.5-arm64/library\n#>  [2] /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library\n#>  * ── Packages attached to the search path.\n#> \n#> ──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}