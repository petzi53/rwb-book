{
  "hash": "008c65ec689cce120aa50b4c4f9e859e",
  "result": {
    "engine": "knitr",
    "markdown": "# Prepare M49 data {#sec-chap021}\n\n\n\n\n\n::::: {#obj-chap021}\n:::: {.my-objectives}\n::: {.my-objectives-header}\nObjectives\n:::\n\n\n::: {.my-objectives-container}\n\nIn this chapter I will prepare the M49 dataset for my use case.\n:::\n::::\n:::::\n\n\n:::::{.my-procedure}\n:::{.my-procedure-header}\n:::::: {#prp-021-prepare-m49-data}\n: Prepare M49 dataset\n::::::\n:::\n::::{.my-procedure-container}\n\n1. Get raw data via parameter handover\n2. Clean column names: Convert all characters to lower letters and spaces to underscore\n3. Filter rows without Antarctica\n4. Substitute `NA`s in the column `intermediate_region_name` with the values from `sub_region_name`\n5. Select appropriate columns\n6. Shorten column names\n\n::::\n:::::\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-021-prepare-m49}\n: Preparing the M49 dataset for my use case\n::::::\n:::\n::::{.my-r-code-container}\n\n\n::: {.cell}\n\n```{#lst-021-prepare-m49 .r .cell-code  lst-cap=\"Function to prepare the M49 dataset for my use case\"}\n## this function will be called from the preparing action of the RWB datasets\n## the code is copied into prepare-m49.R\n\nm49_recoded <- function(df) {\n    df |>                                                     # (1)\n        janitor::clean_names() |>                             # (2)\n        dplyr::filter(country_or_area != \"Antarctica\") |>     # (3)\n        dplyr::mutate(intermediate_region_name =              # (4)\n          base::ifelse(is.na(intermediate_region_name),       \n                   sub_region_name, intermediate_region_name) \n        ) |>                                                  \n        dplyr::select(                                        # (5)\n            iso_alpha3_code,                                  \n            region_name,                                      \n            sub_region_name,                                  \n            intermediate_region_name                          \n        ) |>                                                  \n        dplyr::rename(iso = iso_alpha3_code) |>               # (6) \n        dplyr::rename_with(function(x) {gsub(\"_name\",\"\",x)})  \n}\n\nm49_clean <- m49_recoded(readRDS(paste0(here::here(), \"/data/chap012/m49_raw.rds\")))\n\nmy_save_data_file(\"chap021\", m49_clean, \"m49_clean.rds\")\n```\n:::\n\n\n***\n\n<center>(*For this R code chunk is no output available*)</center>\n\n::::\n:::::\n\n\n## Session Info {.unnumbered}\n\n::: my-r-code\n::: my-r-code-header\nSession Info\n:::\n\n::: my-r-code-container\n\n::: {.cell}\n\n```{.r .cell-code}\nsessioninfo::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> ─ Session info ───────────────────────────────────────────────────────────────\n#>  setting  value\n#>  version  R version 4.5.1 (2025-06-13)\n#>  os       macOS Sequoia 15.6\n#>  system   aarch64, darwin20\n#>  ui       X11\n#>  language (EN)\n#>  collate  en_US.UTF-8\n#>  ctype    en_US.UTF-8\n#>  tz       Europe/Vienna\n#>  date     2025-08-14\n#>  pandoc   3.7.0.2 @ /opt/homebrew/bin/ (via rmarkdown)\n#>  quarto   1.8.4 @ /usr/local/bin/quarto\n#> \n#> ─ Packages ───────────────────────────────────────────────────────────────────\n#>  package     * version    date (UTC) lib source\n#>  cli           3.6.5      2025-04-23 [1] CRAN (R 4.5.0)\n#>  curl          6.4.0      2025-06-22 [1] CRAN (R 4.5.0)\n#>  digest        0.6.37     2024-08-19 [1] CRAN (R 4.5.0)\n#>  evaluate      1.0.4      2025-06-18 [1] CRAN (R 4.5.0)\n#>  fastmap       1.2.0      2024-05-15 [1] CRAN (R 4.5.0)\n#>  glossary    * 1.0.0.9003 2025-06-08 [1] local\n#>  htmltools     0.5.8.1    2024-04-04 [1] CRAN (R 4.5.0)\n#>  htmlwidgets   1.6.4      2023-12-06 [1] CRAN (R 4.5.0)\n#>  jsonlite      2.0.0      2025-03-27 [1] CRAN (R 4.5.0)\n#>  knitr         1.50       2025-03-16 [1] CRAN (R 4.5.0)\n#>  rlang         1.1.6      2025-04-11 [1] CRAN (R 4.5.0)\n#>  rmarkdown     2.29       2024-11-04 [1] CRAN (R 4.5.0)\n#>  rstudioapi    0.17.1     2024-10-22 [1] CRAN (R 4.5.0)\n#>  rversions     2.1.2      2022-08-31 [1] CRAN (R 4.5.0)\n#>  sessioninfo   1.2.3      2025-02-05 [1] CRAN (R 4.5.0)\n#>  xfun          0.52       2025-04-02 [1] CRAN (R 4.5.0)\n#>  xml2          1.3.8      2025-03-14 [1] CRAN (R 4.5.0)\n#>  yaml          2.3.10     2024-07-26 [1] CRAN (R 4.5.0)\n#> \n#>  [1] /Library/Frameworks/R.framework/Versions/4.5-arm64/library\n#>  [2] /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library\n#>  * ── Packages attached to the search path.\n#> \n#> ──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n:::\n:::\n\n",
    "supporting": [
      "021-prepare-m49-data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}