# Prepare map data {#sec-chap023}

::::: {#obj-chap023}
:::: {.my-objectives}
::: {.my-objectives-header}
Objectives
:::

::: {.my-objectives-container}

Here I want to prepare the raw country dataset `ne_countries_raw.rds` for joining later with the RWB dataset `rwb_2022_2025.rds` to generate a `r glossary("choropleth")` map.



:::
::::
:::::

`ne_countries_raw.rds` is a long dataset with 169 columns. I need only the last column `geometry` and a column for joining with the RWB dataset. There are many different columns with ISO values. I settle for `adm0_a3`. 

Additionally, I keep also all columns with regional categories. These are the columns numbers 93 to 96:

- continent: Nr. 93,  6 categories
- region_un: Nr. 94,  5 categories
- subregion: Nr. 95, 22 categories
- region_wb: Nr. 96,  7 categories

(All categories counted without Antarctica.)


:::::{.my-r-code}
:::{.my-r-code-header}
:::::: {#cnj-023-prepare-map-data}
: Prepare map data
::::::
:::
::::{.my-r-code-container}

<center>**Run this code chunk manually if the file(s) still needs to be downloaded.**</center>

```{r}
#| label: prepare-map-data
#| lst-label: lst-023-prepare-map-data
#| lst-cap: Prepare map data to display the World Press Freedom Index
#| eval: false

base::source(file = "R/helper.R")
library(dplyr, warn.conflicts = FALSE)

ne_countries_short <- readRDS(
    paste0(here::here(), 
           "/data/chap013/ne_countries_raw.rds"
           )
    ) |> 
    select(adm0_a3, c(93:96), geometry) |>
    mutate(across(where(is.character), as.factor))


my_save_data_file("chap023", ne_countries_short, "ne_countries_short.rds")


```

***

<center>(*For this R code chunk is no output available*)</center>

::::
:::::


## Glossary Entries {.unnumbered}

```{r}
#| label: glossary-table
#| echo: false

glossary_table()
```

------------------------------------------------------------------------

## Session Info {.unnumbered}

::: my-r-code
::: my-r-code-header
Session Info
:::

::: my-r-code-container
```{r}
#| label: session-info

sessioninfo::session_info()
```
:::
:::

